{% extends "base.html" %}

{% load i18n %}
{% load breadcrumbs %}
{% load navigator %}
{% load details %}
{% load menu %}

{% block meta_title %}{{ object|striptags|capfirst }}{% endblock %}

{% block breadcrumbs %}
    {% add_crumb 'Home' '/' %}
    {% add_crumb 'Letters' 'letter_list' %}
    {% add_crumb object %}
{% endblock %}

{% block title %}
<div class="title">
    <h1>{{ object|escape|capfirst }}</h1>
</div>
{% endblock %}

{% block main %}
<div class="actions">
    <ul>
        {% if perms.partners.add_letter %}
        <li class="add"><a title="{% trans 'Add' %}" href="{% url letter_add %}">{% trans 'Add' %}</a></li>
        {% endif %}
        {% if perms.partners.change_letter %}
        <li class="edit"><a title="{% trans 'Edit' %}" href="{% url letter_edit object.content_object.pk %}">{% trans 'Edit' %}</a></li>
        {% endif %}
        {% if perms.partners.delete_letter %}
        <li class="delete"><a title="{% trans 'Delete' %}" href="{% url letter_delete object.content_object.pk %}">{% trans 'Delete' %}</a></li>
        {% endif %}
        {% if perms.partners.change_letter %}
        <li class="all"><a title="{% trans 'All' %}" href="{% url letter_list %}">{% trans 'All' %}</a></li>
        {% endif %}
        {% if perms.partners.change_letter %}
        <li class="print"><a title="{% trans 'Print' %}" href="{% url document_print object.pk object.content_object.target.language %}">{% trans 'Print' %}</a></li>
        {% endif %}
        {% if perms.partners.change_letter %}
        {% if user not in object.stream.followers.all %}
        <li class="follow"><a title="{% trans 'Follow' %}" href="{% url stream_follow object.stream request.path %}">{% trans 'Follow' %}</a></li>
        {% else %}
        <li class="leave"><a title="{% trans 'Leave' %}" href="{% url stream_leave object.stream request.path %}">{% trans 'Leave' %}</a></li>
        {% endif %}
        {% endif %}
    </ul>
</div>
{% objects_from object "get_for_content" object.content_object %}
{% with objects as object_list %}
{% include 'elements/navigator.html' %}
{% endwith %}
<div class="sections">   
    <div class="menu">
        {% menu "letter_menu" %}
    </div>
    <div class="section">
        {% block section %}
        <div class="details">
            <table class="properties">
                {% property_table object "[['owner', 'status'], ['author', 'created']]" %}
                {% property_table object.content_object "[['target', 'to'], ['location', 'date'], ['target_ref_number', 'target_ref_date'], 'subject', 'body']" %}
                {% property_table object "['categories', 'tags']" %}
            </table>
        </div>
        {% include "elements/comments.html" %}
        {% endblock %}
    </div>
</div>
{% endblock %}
